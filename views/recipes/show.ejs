<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('../partials/head') %>
</head>

<body>
    <%- include('../partials/header') %>
        <% recipe.forEach((recipe_info)=> {%>
            <div class="container-fluid">
                <div class="row">
                    <div class="col-6">
                        <header class="container mt-5 mx-3 px-5">
                            <h1>
                                <%= recipe_info['r_title'] %>
                            </h1>
                            <p class="mb-5">Add one sentence description of recipe here</p>
                        </header>
                        <div class="mx-3 px-5 mb-4">
                            <p class="fw-semibold fs-5 mb-1">Ingredients</p>
                            <p>
                                <%= recipe_info['ingredients'] %>
                            </p>
                        </div>
                        <div class="mx-3 px-5">
                            <p class="fw-semibold fs-5 mb-1">Directions</p>
                            <p>
                                <%= recipe_info['directions'] %>
                            </p>
                        </div>
                    </div>
                    <div class="col-6">
                        <div class="row mt-5 me-3 pe-5">
                            <div class="bg-secondary-subtle py-5">
                                <p class="text-center">IMAGE GOES HERE</p>
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="col">
                                <div class="me-3 pe-5 float-end">
                                    <button type="button" class="btn btn-dark" id="createComment">Comment</button>
                                    <a href="<%=`/recipes/${recipe_info['id']}/edit`%>" class="btn btn-dark">Edit</a>
                                    <a href="<%=`/recipes/${recipe_info['id']}/delete`%>"
                                        onclick="return confirm('Are you sure you want to delete this recipe?');"
                                        class="btn btn-dark">Delete</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="container mt-5 mx-3 px-5">
                            <form action="<%=`/recipes/comment/${recipe_info['id']}`%>" method="POST">
                                <div class="row mt-4" id="commentForm"></div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <% }); %>
                <% comments.forEach((comment)=> {%>
                    <div class="container" id="<%=`comment-container-${comment['comment_id']}`%>">
                        <div class="col comment-background" id="">
                            <div class="row">
                                <h6 class="ms-4 mb-0 pt-4 fw-semibold">
                                    <%=comment['first_name']%>
                                        <%=comment['last_name']%>
                                </h6>
                            </div>
                            <div class="row">
                                <h6>
                                    <h6 class="ms-4 pb-2 fw-light">
                                        <%const createdAt=comment['created_at']%>
                                        <%='Commented'%> <%=dayjs(createdAt).fromNow();%>
                                    </h6>
                                </h6>
                            </div>
                            <div class="row">
                                <h6 id="<%=`comment-${comment['comment_id']}`%>" class=" ms-4 fw-normal">
                                    <%=comment['comment']%>
                                </h6>
                            </div>
                            <form action="<%=`/recipes/${comment['recipe_id']}/comment/edit/${comment['comment_id']}`%>"
                                method="POST" class="mx-4">
                            </form>
                            <div class="row">
                                <div class="col me-3 mb-3">
                                    <div class="float-end">
                                        <button type="button" class="btn btn-dark edit-comment-btn"
                                            id="<%=`comment-edit-button-id-${comment['comment_id']}`%>"
                                            data-comment-id="<%= comment['comment_id'] %>">Edit</button>
                                        <a href="<%=`/recipes/${comment['recipe_id']}/comment/delete/${comment['comment_id']}`%>"
                                            onclick="return confirm('Are you sure you want to delete this comment?');"
                                            class="btn btn-dark"
                                            id="<%=`comment-delete-button-id-${comment['comment_id']}`%>">Delete</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <hr class="solid mt-3">
                        </div>
                    </div>
                    <% }); %>
</body>

<script src="/javascripts/comments.js" type="text/javascript"></script>

</html>